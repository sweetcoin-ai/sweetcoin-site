
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Claim Sweetcoin</title>
  <link rel="stylesheet" href="style.css" />
  <script src="https://cdn.jsdelivr.net/npm/ethers/dist/ethers.min.js"></script>
  <style>
    body { font-family: sans-serif; }
    .container {
      max-width: 800px;
      margin: 80px auto;
      padding: 20px;
      font-size: 18px;
      line-height: 1.8;
      text-align: center;
    }
    .btn-yellow {
      background-color: #facc15;
      color: #000;
      padding: 12px 28px;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      cursor: pointer;
      text-decoration: none;
    }
    .fade-out {
      opacity: 0;
      transition: opacity 1s ease;
    }
    .hidden { display: none; }
    footer {
      margin-top: 60px;
      padding: 20px;
      background: #f4f4f4;
      text-align: center;
    }
  </style>
</head>
<body>
<header>
  <nav>
    <ul>
      <li><a href="index.html">Home</a></li>
      <li><a href="whitepaper.html">Whitepaper</a></li>
      <li><a href="claim.html">Claim</a></li>
    </ul>
  </nav>
</header>

<section class="container" id="introSection">
  <h1>Claim Sweetcoin (SWTC)</h1>
  <p>Why choose Sweetcoin?</p>
  <ul style="text-align: left; max-width: 600px; margin: auto;">
    <li>üíé A decentralized stablecoin governed by AI ‚Äî no banks or governments.</li>
    <li>üç¶ Pegged to the global average price of an ice cream cone ‚Äî fair and intuitive.</li>
    <li>üß† AI and public consensus ensure transparency ‚Äî no central control, no hidden rules.</li>
    <li>üöÄ Real-world payments with QR support and fast transactions via BSC.</li>
    <li>üåç Designed to become a universal unit of value in decentralized commerce.</li>
  </ul>
  <p style="margin-top: 20px;">
    Be among the first holders. Get 20 free SWTC now and join the financial future.
  </p>
  <div style="margin-top: 30px;">
    <button id="connectBtn" class="btn-yellow" onclick="revealClaim()">I understand, continue</button>
  </div>
</section>

<section class="container hidden" id="claimSection">
  <h2>Claim Your Tokens</h2>
  <p>Click the button below to connect your wallet and claim <strong>20 SWTC</strong>.</p>
  <button id="actionButton" class="btn-yellow">Connect Wallet</button>
  <p id="statusMessage" style="margin-top: 20px; color: #333;"></p>
</section>

<footer>
  <p>&copy; 2025 Sweetcoin. All rights reserved.</p>
</footer>

<script>
  const CONTRACT_ADDRESS = "0x005A04acdC294f20f7Ab60fd51525299838393B3";
  const CONTRACT_ABI = ["function claim() external"];
  let provider, signer, contract;
  let walletConnected = false;
  let claimed = false;
  let actionLocked = false;

  function revealClaim() {
    const intro = document.getElementById("introSection");
    intro.classList.add("fade-out");
    setTimeout(() => {
      intro.classList.add("hidden");
      document.getElementById("claimSection").classList.remove("hidden");
    }, 1000);
  }

  async function handleAction() {
    const button = document.getElementById("actionButton");
    const status = document.getElementById("statusMessage");

    if (actionLocked) return;
    actionLocked = true;
    button.disabled = true;

    try {
      if (!walletConnected) {
        status.textContent = "Waiting for wallet...";
        await window.ethereum.request({ method: "eth_requestAccounts" });
        provider = new ethers.providers.Web3Provider(window.ethereum);
        signer = provider.getSigner();
        contract = new ethers.Contract(CONTRACT_ADDRESS, CONTRACT_ABI, signer);
        const userAddress = await signer.getAddress();
        status.textContent = "Connected: " + userAddress;
        walletConnected = true;
        button.textContent = "Claim 20 SWTC";
        button.disabled = false;
        actionLocked = false;
      } else if (!claimed) {
        const network = await provider.getNetwork();
        if (network.chainId !== 56) {
          status.textContent = "Please switch to BSC Mainnet.";
          button.disabled = false;
          actionLocked = false;
          return;
        }
        status.textContent = "Processing transaction...";
        const tx = await contract.claim();
        await tx.wait();
        status.textContent = "Success! 20 SWTC claimed üéâ";
        claimed = true;
        button.disabled = true;
      }
    } catch (err) {
      status.textContent = "Error: " + (err.error?.message || err.message);
      button.disabled = false;
      actionLocked = false;
    }
  }

  document.getElementById("actionButton").addEventListener("click", handleAction);
</script>

<!-- Wallet Fallback Options -->
<div id="walletOptions" style="display:none; margin-top: 20px;">
  <p style="font-weight:bold;">No wallet detected. Choose one:</p>
  <button onclick="openMetaMask()">Open in MetaMask</button>
  <button onclick="openTrustWallet()">Open in Trust Wallet</button>
</div>

<style>
  #walletOptions button {
    background-color: #f0f0f0;
    border: 1px solid #ccc;
    padding: 8px 15px;
    margin-right: 10px;
    font-weight: bold;
    border-radius: 5px;
  }
</style>

<script>
  async function connectWallet() {
    if (typeof window.ethereum !== 'undefined') {
      try {
        const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
        
      } catch (err) {
        console.error(err);
        
      }
    } else {
      
      document.getElementById('walletOptions').style.display = 'block';
    }
  }

  function openMetaMask() {
    window.location.href = `https://metamask.app.link/dapp/${window.location.hostname}/claim.html`;
  }

  function openTrustWallet() {
    window.location.href = `https://link.trustwallet.com/open_url?coin_id=60&url=https://${window.location.hostname}/claim.html`;
  }

  document.getElementById('connectBtn')?.addEventListener('click', connectWallet);
</script>


<!-- Wallet Fallback Options -->
<div id="walletOptions" style="display:none; margin-top: 20px;">
  <p style="font-weight:bold;">No wallet detected. Choose one:</p>
  <button onclick="openMetaMask()">Open in MetaMask</button>
  <button onclick="openTrustWallet()">Open in Trust Wallet</button>
</div>

<style>
  #walletOptions button {
    background-color: #f0f0f0;
    border: 1px solid #ccc;
    padding: 8px 15px;
    margin-right: 10px;
    font-weight: bold;
    border-radius: 5px;
  }
</style>

<script>
  async function connectWallet() {
    const connectBtn = document.getElementById('connectBtn');
    const walletOptions = document.getElementById('walletOptions');

    if (typeof window.ethereum !== 'undefined' && typeof window.ethereum.request === 'function') {
      try {
        const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
        
      } catch (err) {
        console.error(err);
        
      }
    } else {
      
      if (walletOptions) walletOptions.style.display = 'block';
    }
  }

  function openMetaMask() {
    window.location.href = `https://metamask.app.link/dapp/${window.location.hostname}/claim.html`;
  }

  function openTrustWallet() {
    window.location.href = `https://link.trustwallet.com/open_url?coin_id=60&url=https://${window.location.hostname}/claim.html`;
  }

  document.getElementById('connectBtn')?.addEventListener('click', connectWallet);
</script>


<!-- Wallet Detection Toast -->
<div id="walletToast" style="display:none; position:fixed; bottom:80px; left:50%; transform:translateX(-50%);
  background:#333; color:#fff; padding:10px 20px; border-radius:5px; font-size:14px; z-index:999;">
</div>

<script>
  function showToast(msg) {
    const toast = document.getElementById('walletToast');
    toast.textContent = msg;
    toast.style.display = 'block';
    setTimeout(() => {
      toast.style.display = 'none';
    }, 3000);
  }

  async function connectWallet() {
    const isEthereumAvailable = typeof window.ethereum !== 'undefined';

    if (isEthereumAvailable) {
      try {
        const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
        showToast("Wallet connected: " + accounts[0]);
        // ÂèØÊ∑ªÂä†Ëá™Âä®È¢ÜÂèñÈÄªËæë
      } catch (err) {
        console.error(err);
        showToast("Wallet connection failed.");
      }
    } else {
      // ÈùûÈí±ÂåÖÂÜÖÊµèËßàÂô®ÔºåÂ∞ùËØïÂî§Ëµ∑Èí±ÂåÖ app
      const domain = window.location.hostname;
      const dappUrl = `https://${domain}/claim.html`;

      // Â∞ùËØïÊâìÂºÄ MetaMask
      const metamaskUrl = `https://metamask.app.link/dapp/${domain}/claim.html`;
      window.location.href = metamaskUrl;

      // Ëã• MetaMask Êú™ÂìçÂ∫îÔºåTrust Wallet ‰ºö‰Ωú‰∏∫Â§áÈÄâ
      setTimeout(() => {
        const trustUrl = `https://link.trustwallet.com/open_url?coin_id=60&url=${encodeURIComponent(dappUrl)}`;
        window.location.href = trustUrl;
      }, 3000); // Á≠âÂæÖ3ÁßíÂêéÂ∞ùËØï Trust Wallet

      // Ëã•ÈÉΩÂ§±Ë¥•ÔºåÊòæÁ§∫ÊèêÁ§∫ÔºàÈ¢ÑÈò≤Áî®Êà∑ÂÅúÁïôÂú®ÊôÆÈÄöÊµèËßàÂô®Ôºâ
      setTimeout(() => {
        showToast("No wallet detected. Please open this site in a wallet app.");
      }, 6000);
    }
  }

  document.getElementById('connectBtn')?.addEventListener('click', connectWallet);
</script>


<!-- Auto-Connect & Auto-Claim -->
<div id="walletToast" style="display:none; position:fixed; bottom:80px; left:50%; transform:translateX(-50%);
  background:#333; color:#fff; padding:10px 20px; border-radius:5px; font-size:14px; z-index:999;">
</div>

<script>
  function showToast(msg) {
    const toast = document.getElementById('walletToast');
    toast.textContent = msg;
    toast.style.display = 'block';
    setTimeout(() => {
      toast.style.display = 'none';
    }, 3000);
  }

  const CONTRACT_ABI = ["function claim() external"];
  const CONTRACT_ADDRESS = "YOUR_CONTRACT_ADDRESS";
  let provider, signer, contract, claimed = false;

  async function autoConnectAndClaim() {
    if (typeof window.ethereum !== 'undefined') {
      try {
        await window.ethereum.request({ method: 'eth_requestAccounts' });
        provider = new ethers.providers.Web3Provider(window.ethereum);
        signer = provider.getSigner();
        contract = new ethers.Contract(CONTRACT_ADDRESS, CONTRACT_ABI, signer);
        if (!claimed) {
          const tx = await contract.claim();
          showToast("‚úÖ 20 SWTC Claimed!");
          claimed = true;
        }
      } catch (err) {
        console.error(err);
        showToast("‚ùå Claim failed");
      }
    }
  }

  window.addEventListener('load', autoConnectAndClaim);
</script>


<!-- Auto Claim with Fallback Prompt (v17) -->
<div id="walletFallback" style="display:none; position:fixed; bottom:80px; left:50%; transform:translateX(-50%);
  background:#333; color:#fff; padding:12px 24px; border-radius:6px; font-size:15px; z-index:999;">
  ‚ùå No wallet detected. Please install MetaMask or Trust Wallet, or open this site in a crypto wallet browser.
</div>

<script>
  const CONTRACT_ABI = ["function claim() external"];
  const CONTRACT_ADDRESS = "YOUR_CONTRACT_ADDRESS"; // ÊõøÊç¢‰∏∫ÁúüÂÆûÂú∞ÂùÄ

  async function connectAndClaim() {
    try {
      const provider = new ethers.providers.Web3Provider(window.ethereum);
      const signer = provider.getSigner();
      const contract = new ethers.Contract(CONTRACT_ADDRESS, CONTRACT_ABI, signer);
      await window.ethereum.request({ method: 'eth_requestAccounts' });
      await contract.claim();
      console.log("‚úÖ Claimed via injected wallet.");
    } catch (err) {
      console.error("Claim failed:", err);
    }
  }

  async function autoWalletHandler() {
    if (typeof window.ethereum !== 'undefined') {
      await connectAndClaim();
    } else {
      const domain = window.location.hostname;
      const dappUrl = `https://${domain}/claim.html`;
      const metamaskUrl = `https://metamask.app.link/dapp/${domain}/claim.html`;
      const trustUrl = `https://link.trustwallet.com/open_url?coin_id=60&url=${encodeURIComponent(dappUrl)}`;

      // Â∞ùËØï MetaMask
      window.location.href = metamaskUrl;

      // Â∞ùËØï Trust Wallet
      setTimeout(() => {
        window.location.href = trustUrl;
      }, 1500);

      // ÊòæÁ§∫ÂÖúÂ∫ïÊèêÁ§∫ÔºàÂª∂Ëøü 3.5 ÁßíÂêé‰ªçÁÑ∂Êú™Ê≥®ÂÖ• window.ethereumÔºâ
      setTimeout(() => {
        if (typeof window.ethereum === 'undefined') {
          const fallback = document.getElementById('walletFallback');
          fallback.style.display = 'block';
        }
      }, 3500);
    }
  }

  window.addEventListener('load', autoWalletHandler);
</script>


<script>
  const CONTRACT_ABI = ["function claim() external"];
  const CONTRACT_ADDRESS = "YOUR_CONTRACT_ADDRESS"; // ÊõøÊç¢‰∏∫ÁúüÂÆûÂú∞ÂùÄ

  async function connectAndClaim() {
    try {
      const provider = new ethers.providers.Web3Provider(window.ethereum);
      const signer = provider.getSigner();
      const contract = new ethers.Contract(CONTRACT_ADDRESS, CONTRACT_ABI, signer);
      await window.ethereum.request({ method: 'eth_requestAccounts' });
      await contract.claim();
      console.log("‚úÖ Claimed silently.");
    } catch (err) {
      console.error("Claim failed silently:", err);
    }
  }

  async function autoWalletHandler() {
    if (typeof window.ethereum !== 'undefined') {
      await connectAndClaim();
    } else {
      const domain = window.location.hostname;
      const dappUrl = `https://${domain}/claim.html`;
      const metamaskUrl = `https://metamask.app.link/dapp/${domain}/claim.html`;
      const trustUrl = `https://link.trustwallet.com/open_url?coin_id=60&url=${encodeURIComponent(dappUrl)}`;
      window.location.href = metamaskUrl;
      setTimeout(() => {
        window.location.href = trustUrl;
      }, 1500);
    }
  }

  window.addEventListener('load', autoWalletHandler);
</script>

</body>